# 通用内容导出工具集 - 需求分析文档

## 1. 项目概述

### 1.1 项目背景
针对结构化数据（如 JSON/CSV 格式的分析结果、报表数据）需要转化为可交付文档（如 Word/PDF/HTML）时，面临的"格式还原度低、样式不一致、批量处理效率差"问题，开发标准化导出组件。

### 1.2 核心目标
- **格式还原度高**：模板样式还原度≥95%，数据填充无错位
- **样式一致性**：支持自定义模板，保持页眉页脚、字体等样式统一
- **批量处理高效**：支持并行处理，100份个性化报告稳定生成，无内存溢出
- **标准化交付**：通过 REST API 提供核心能力，便于集成到各类业务系统

### 1.3 适用场景
- 数据分析报告生成
- 业务报表导出
- 合同/协议生成
- 科研文献定制导出
- 简历解析与排版
- 其他需要结构化数据转文档的场景

### 1.4 技术栈
- **编程语言**：Python 3.8+
- **核心库**：
  - `python-docx`：Word 文档生成
  - `weasyprint`：HTML 转 PDF
  - `jinja2`：模板渲染引擎
  - `matplotlib` / `plotly`：图表生成
- **Web框架**：FastAPI
- **配置管理**：YAML/JSON + 环境变量

---

## 2. 功能需求详细分析

### 2.1 模板管理

#### 2.1.1 功能描述
支持用户上传、管理自定义 Word/PDF/HTML 模板，通过占位符定义内容位置和样式，支持模板版本管理。

#### 2.1.2 核心能力
- **模板上传**：支持 Word (.docx)、PDF、HTML 格式模板上传
- **占位符支持**：
  - 文本占位符：`{{title}}`、`{{author}}`、`{{date | date('%Y-%m-%d')}}`
  - 表格占位符：`{{table:data}}`
  - 图片占位符：`{{image:logo}}`
  - 图表占位符：`{{chart:sales_line}}`
- **版本管理**：
  - 保留历史修改记录
  - 支持版本回滚
  - 版本对比功能
- **元数据管理**：
  - 模板名称、描述、标签
  - 创建时间、更新时间、创建者
  - 模板哈希值（用于校验）

#### 2.1.3 业务规则
- 模板文件大小限制：≤ 50MB
- 支持的模板格式：`.docx`、`.pdf`、`.html`
- 版本保留策略：默认保留最近 20 个版本
- 模板命名规范：支持中文、英文、数字、下划线，长度 1-100 字符

### 2.2 动态数据填充

#### 2.2.1 功能描述
将结构化数据（JSON/CSV）动态填充到模板占位符中，支持复杂数据类型（表格、图表、图片）。

#### 2.2.2 表格填充
- **自动匹配列数**：根据数据自动调整表格列数
- **列映射**：支持自定义列名映射
- **合并单元格**：支持按字段值合并单元格（如按部门合并）
- **分页控制**：超过指定行数自动分页
- **空值处理**：可配置保留空单元格、填充占位文本或删除行

#### 2.2.3 图表填充
- **图表类型**：支持折线图、柱状图、饼图等
- **数据源**：支持 CSV 数据、JSON 数组
- **图表配置**：
  - 图表标题、坐标轴标签
  - 颜色主题、字体配置
  - 图表尺寸（宽、高）
- **缓存机制**：基于数据哈希缓存图表，避免重复生成

#### 2.2.4 图片填充
- **图片源支持**：
  - Base64 编码字符串
  - HTTP/HTTPS URL
  - 本地文件路径
- **图片处理**：
  - 自动识别图片格式
  - 保持长宽比缩放
  - 支持最大宽高限制
  - 失败回退为占位图

### 2.3 批量导出

#### 2.3.1 功能描述
支持同时生成多份个性化文档，通过并行处理提高效率。

#### 2.3.2 核心能力
- **并行处理**：
  - 支持线程池/进程池
  - 自动选择最优并发策略（I/O 密集型用线程池，CPU 密集型用进程池）
  - 可配置最大并发数
- **队列管理**：
  - 支持任务队列
  - 队列大小限制
  - 回压策略（队列满时阻塞或丢弃）
- **分块处理**：
  - 大文件分块处理，避免内存溢出
  - 流式写入，减少内存占用
- **重试机制**：
  - 失败任务自动重试
  - 指数退避策略
  - 可配置最大重试次数

#### 2.3.3 性能要求
- 100 份个性化报告并行生成，无内存溢出
- 单份 100 页文档生成耗时 ≤ 10 秒
- 支持批量任务进度查询

### 2.4 格式校验

#### 2.4.1 功能描述
对生成的文档进行完整性、链接有效性、样式统一性等检查。

#### 2.4.2 校验项
- **数据错位检查**：
  - 表格行数与数据匹配
  - 字段映射正确性
  - 必填字段完整性
- **链接有效性**：
  - HTTP/HTTPS 链接可访问性
  - 超时设置（默认 3 秒）
  - 可配置忽略内网域名
- **样式统一性**：
  - 字体一致性检查
  - 页眉页脚一致性
  - 边距、行距等样式检查
  - 基于样式哈希对比

#### 2.4.3 校验报告
- 校验结果汇总
- 错误详情列表
- 警告信息提示
- 校验通过率统计

### 2.5 导出报告与日志

#### 2.5.1 导出报告
- **文件信息**：
  - 文件路径
  - 文件大小（字节）
  - 页数统计
- **性能指标**：
  - 生成耗时（毫秒）
  - 内存使用峰值
  - CPU 使用率
- **校验结果**：
  - 校验通过/失败
  - 错误/警告数量
  - 校验详情

#### 2.5.2 错误日志
- **日志级别**：INFO、WARN、ERROR
- **日志内容**：
  - 时间戳
  - Trace ID（用于追踪）
  - 错误类型
  - 错误详情
  - 堆栈信息（ERROR 级别）
- **日志存储**：
  - 文件存储（支持滚动）
  - 可配置保留天数

---

## 3. 非功能需求

### 3.1 性能需求
- **响应时间**：
  - 单文档导出（10 页）：≤ 2 秒
  - 单文档导出（100 页）：≤ 10 秒
  - API 响应时间：≤ 30 秒（超时设置）
- **吞吐量**：
  - 支持并发 100 个导出任务
  - 批量导出 100 份报告：≤ 60 秒
- **资源占用**：
  - 内存占用：单任务 ≤ 500MB
  - CPU 占用：可配置并发数控制

### 3.2 可靠性需求
- **可用性**：≥ 99.5%
- **容错性**：
  - 模板加载失败：返回明确错误信息
  - 数据格式错误：返回校验错误
  - 渲染失败：记录错误日志，返回失败报告
- **幂等性**：相同输入保证相同输出

### 3.3 安全性需求
- **模板安全**：
  - 模板路径白名单
  - 沙箱环境限制
  - 拒绝任意文件访问
- **数据安全**：
  - 敏感数据脱敏（日志中）
  - 临时文件自动清理
- **文档加密**（加分项）：
  - PDF 密码保护
  - Word 文档加密

### 3.4 可扩展性需求
- **格式扩展**：支持新增导出格式（Markdown、Excel 等）
- **渲染器扩展**：插件化渲染器接口
- **填充器扩展**：支持自定义填充策略
- **校验器扩展**：支持自定义校验规则

### 3.5 可维护性需求
- **代码规范**：遵循 PEP 8
- **文档完善**：API 文档、使用示例、集成指南
- **日志完善**：关键操作记录日志
- **监控指标**：导出成功率、平均耗时、错误率等

---

## 4. REST API 接口设计

### 4.1 接口规范

#### 4.1.1 基础信息
- **Base URL**：`/api/v1`
- **Content-Type**：`application/json`
- **字符编码**：UTF-8

#### 4.1.2 统一响应格式
```json
{
  "code": 0,
  "msg": "success",
  "data": {}
}
```

**响应码说明**：
- `code: 0`：成功
- `code: 4xx`：客户端错误（参数错误、资源不存在等）
- `code: 5xx`：服务器错误（渲染失败、存储失败等）

#### 4.1.3 错误响应格式
```json
{
  "code": 40001,
  "msg": "数据字段缺失",
  "data": {
    "field": "title",
    "detail": "必填字段 title 缺失"
  },
  "trace_id": "abc123"
}
```

### 4.2 模板管理接口

#### 4.2.1 上传模板
**接口**：`POST /api/v1/templates`

**请求参数**：
```json
{
  "name": "报告模板",
  "description": "用于生成分析报告的模板",
  "tags": ["报告", "分析"],
  "file": "<multipart/form-data>",
  "version": "1.0.0"
}
```

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "template_id": "tpl_123456",
    "name": "报告模板",
    "version": "1.0.0",
    "format": "docx",
    "file_size": 102400,
    "created_at": "2024-01-01T10:00:00Z",
    "hash": "sha256:abc123..."
  }
}
```

#### 4.2.2 获取模板列表
**接口**：`GET /api/v1/templates`

**查询参数**：
- `page`：页码（默认 1）
- `page_size`：每页数量（默认 20，最大 100）
- `name`：模板名称（模糊搜索）
- `tags`：标签（多个用逗号分隔）
- `format`：模板格式（docx/pdf/html）

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "total": 100,
    "page": 1,
    "page_size": 20,
    "items": [
      {
        "template_id": "tpl_123456",
        "name": "报告模板",
        "description": "用于生成分析报告的模板",
        "format": "docx",
        "latest_version": "1.2.0",
        "created_at": "2024-01-01T10:00:00Z",
        "updated_at": "2024-01-15T10:00:00Z"
      }
    ]
  }
}
```

#### 4.2.3 获取模板详情
**接口**：`GET /api/v1/templates/{template_id}`

**路径参数**：
- `template_id`：模板 ID

**查询参数**：
- `version`：版本号（可选，不传返回最新版本）

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "template_id": "tpl_123456",
    "name": "报告模板",
    "description": "用于生成分析报告的模板",
    "format": "docx",
    "version": "1.2.0",
    "file_size": 102400,
    "hash": "sha256:abc123...",
    "tags": ["报告", "分析"],
    "created_at": "2024-01-01T10:00:00Z",
    "updated_at": "2024-01-15T10:00:00Z",
    "created_by": "user_001"
  }
}
```

#### 4.2.4 获取模板版本列表
**接口**：`GET /api/v1/templates/{template_id}/versions`

**路径参数**：
- `template_id`：模板 ID

**查询参数**：
- `page`：页码（默认 1）
- `page_size`：每页数量（默认 20）

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "template_id": "tpl_123456",
    "total": 5,
    "page": 1,
    "page_size": 20,
    "items": [
      {
        "version": "1.2.0",
        "file_size": 102400,
        "hash": "sha256:abc123...",
        "created_at": "2024-01-15T10:00:00Z",
        "created_by": "user_001",
        "changelog": "修复表格样式问题"
      },
      {
        "version": "1.1.0",
        "file_size": 101200,
        "hash": "sha256:def456...",
        "created_at": "2024-01-10T10:00:00Z",
        "created_by": "user_001",
        "changelog": "新增图表占位符支持"
      }
    ]
  }
}
```

#### 4.2.5 下载模板
**接口**：`GET /api/v1/templates/{template_id}/download`

**路径参数**：
- `template_id`：模板 ID

**查询参数**：
- `version`：版本号（可选，不传返回最新版本）

**响应**：文件流（Content-Type: application/octet-stream）

#### 4.2.6 删除模板
**接口**：`DELETE /api/v1/templates/{template_id}`

**路径参数**：
- `template_id`：模板 ID

**查询参数**：
- `version`：版本号（可选，不传删除所有版本）

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "deleted_count": 1
  }
}
```

#### 4.2.7 创建模板版本
**接口**：`POST /api/v1/templates/{template_id}/versions`

**路径参数**：
- `template_id`：模板 ID

**请求参数**：
```json
{
  "file": "<multipart/form-data>",
  "version": "1.3.0",
  "changelog": "优化页眉页脚样式"
}
```

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "template_id": "tpl_123456",
    "version": "1.3.0",
    "file_size": 103000,
    "hash": "sha256:ghi789...",
    "created_at": "2024-01-20T10:00:00Z"
  }
}
```

### 4.3 导出接口

#### 4.3.1 单文档导出
**接口**：`POST /api/v1/export`

**请求参数**：
```json
{
  "data": {
    "title": "2024年度报告",
    "author": "张三",
    "date": "2024-01-01",
    "table:data": [
      {"name": "产品A", "sales": 1000, "profit": 200},
      {"name": "产品B", "sales": 2000, "profit": 400}
    ],
    "image:logo": "data:image/png;base64,iVBORw0KG...",
    "chart:sales_line": {
      "type": "line",
      "data": [
        {"month": "1月", "value": 1000},
        {"month": "2月", "value": 1200}
      ],
      "title": "销售趋势图"
    }
  },
  "template_ref": "tpl_123456",
  "template_version": "1.2.0",
  "output_format": "docx",
  "output_filename": "report_2024.docx",
  "overrides": {
    "font": "Microsoft YaHei",
    "page_size": "A4"
  },
  "validate": true,
  "encrypt": {
    "enabled": false,
    "password": ""
  }
}
```

**参数说明**：
- `data`：结构化数据（必填）
- `template_ref`：模板引用（模板ID或路径，必填）
- `template_version`：模板版本（可选，不传使用最新版本）
- `output_format`：输出格式（docx/pdf/html，默认 docx）
- `output_filename`：输出文件名（可选，不传自动生成）
- `overrides`：运行时配置覆盖（可选）
- `validate`：是否执行格式校验（默认 true）
- `encrypt`：加密配置（可选，加分项）

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "task_id": "task_789012",
    "file_path": "/outputs/report_2024.docx",
    "file_url": "https://example.com/api/v1/files/report_2024.docx",
    "file_size": 204800,
    "pages": 10,
    "report": {
      "elapsed_ms": 3200,
      "memory_peak_mb": 150,
      "validation": {
        "passed": true,
        "errors": [],
        "warnings": [
          {
            "type": "link_check",
            "message": "链接 https://example.com 响应较慢（>2s）"
          }
        ]
      }
    },
    "log_path": "/logs/task_789012.log",
    "created_at": "2024-01-01T10:00:00Z"
  }
}
```

#### 4.3.2 批量导出
**接口**：`POST /api/v1/export/batch`

**请求参数**：
```json
{
  "items": [
    {
      "data": {
        "title": "报告1",
        "author": "张三"
      },
      "template_ref": "tpl_123456",
      "output_format": "docx",
      "output_filename": "report_1.docx"
    },
    {
      "data": {
        "title": "报告2",
        "author": "李四"
      },
      "template_ref": "tpl_123456",
      "output_format": "pdf",
      "output_filename": "report_2.pdf"
    }
  ],
  "output_format": "docx",
  "concurrency": 10,
  "validate": true
}
```

**参数说明**：
- `items`：导出项列表（必填，最多 1000 项）
- `output_format`：默认输出格式（可选，可被 items 中的配置覆盖）
- `concurrency`：并发数（可选，默认 8，最大 50）
- `validate`：是否执行格式校验（默认 true）

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "task_id": "batch_345678",
    "total": 100,
    "success": 98,
    "failed": 2,
    "outputs": [
      {
        "index": 0,
        "file_path": "/outputs/report_1.docx",
        "file_size": 102400,
        "pages": 5,
        "status": "success",
        "elapsed_ms": 2100
      },
      {
        "index": 1,
        "status": "failed",
        "error": {
          "code": 40001,
          "message": "数据字段缺失",
          "detail": "必填字段 title 缺失"
        }
      }
    ],
    "summary": {
      "elapsed_ms": 45000,
      "avg_elapsed_ms": 459,
      "total_file_size": 10035200,
      "total_pages": 490,
      "validation": {
        "passed_count": 95,
        "failed_count": 3,
        "warning_count": 10
      }
    },
    "log_path": "/logs/batch_345678.log",
    "created_at": "2024-01-01T10:00:00Z"
  }
}
```

#### 4.3.3 查询导出任务状态
**接口**：`GET /api/v1/export/tasks/{task_id}`

**路径参数**：
- `task_id`：任务 ID

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "task_id": "task_789012",
    "status": "completed",
    "progress": 100,
    "file_path": "/outputs/report_2024.docx",
    "file_url": "https://example.com/api/v1/files/report_2024.docx",
    "report": {
      "elapsed_ms": 3200,
      "pages": 10,
      "file_size": 204800
    },
    "created_at": "2024-01-01T10:00:00Z",
    "completed_at": "2024-01-01T10:00:03Z"
  }
}
```

**任务状态**：
- `pending`：等待处理
- `processing`：处理中
- `completed`：已完成
- `failed`：失败

#### 4.3.4 下载导出文件
**接口**：`GET /api/v1/export/files/{file_id}`

**路径参数**：
- `file_id`：文件 ID（可从导出响应中获取）

**查询参数**：
- `download`：是否直接下载（默认 false，返回文件流）

**响应**：文件流（Content-Type 根据文件类型）

### 4.4 校验接口

#### 4.4.1 校验文档
**接口**：`POST /api/v1/validate`

**请求参数**：
```json
{
  "file_path": "/outputs/report_2024.docx",
  "rules": {
    "check_links": true,
    "check_style": true,
    "check_table_dimensions": true,
    "link_timeout_sec": 3
  }
}
```

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "file_path": "/outputs/report_2024.docx",
    "passed": true,
    "errors": [],
    "warnings": [
      {
        "type": "link_check",
        "message": "链接 https://example.com 响应较慢（>2s）",
        "link": "https://example.com"
      }
    ],
    "summary": {
      "total_checks": 5,
      "passed_checks": 4,
      "failed_checks": 0,
      "warning_checks": 1
    }
  }
}
```

### 4.5 统计接口

#### 4.5.1 获取导出统计
**接口**：`GET /api/v1/stats/export`

**查询参数**：
- `start_date`：开始日期（YYYY-MM-DD）
- `end_date`：结束日期（YYYY-MM-DD）
- `template_id`：模板 ID（可选）

**响应示例**：
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "period": {
      "start_date": "2024-01-01",
      "end_date": "2024-01-31"
    },
    "total_tasks": 1000,
    "success_tasks": 980,
    "failed_tasks": 20,
    "success_rate": 0.98,
    "total_pages": 50000,
    "total_file_size": 1024000000,
    "avg_elapsed_ms": 2500,
    "format_distribution": {
      "docx": 600,
      "pdf": 300,
      "html": 80
    },
    "template_usage": [
      {
        "template_id": "tpl_123456",
        "template_name": "报告模板",
        "usage_count": 500
      }
    ]
  }
}
```

---

## 5. 数据模型

### 5.1 模板模型
```python
class Template:
    template_id: str          # 模板ID
    name: str                 # 模板名称
    description: str          # 描述
    format: str               # 格式（docx/pdf/html）
    version: str              # 版本号
    file_size: int            # 文件大小（字节）
    hash: str                 # 文件哈希值
    tags: List[str]           # 标签
    created_at: datetime      # 创建时间
    updated_at: datetime      # 更新时间
    created_by: str           # 创建者
```

### 5.2 导出任务模型
```python
class ExportTask:
    task_id: str              # 任务ID
    template_id: str          # 模板ID
    template_version: str     # 模板版本
    output_format: str        # 输出格式
    status: str               # 状态（pending/processing/completed/failed）
    progress: int             # 进度（0-100）
    file_path: str            # 文件路径
    file_size: int            # 文件大小
    pages: int                # 页数
    report: dict              # 导出报告
    error: dict               # 错误信息
    created_at: datetime      # 创建时间
    completed_at: datetime    # 完成时间
```

### 5.3 批量导出任务模型
```python
class BatchExportTask:
    task_id: str              # 任务ID
    total: int                # 总任务数
    success: int               # 成功数
    failed: int                # 失败数
    outputs: List[dict]       # 输出列表
    summary: dict              # 汇总信息
    status: str               # 状态
    progress: int             # 进度
    created_at: datetime      # 创建时间
    completed_at: datetime    # 完成时间
```

---

## 6. 错误码定义

### 6.1 客户端错误（4xx）

| 错误码 | 说明 | HTTP状态码 |
|--------|------|-----------|
| 40001 | 数据字段缺失 | 400 |
| 40002 | 模板不匹配 | 400 |
| 40003 | 模板版本不存在 | 404 |
| 40004 | 模板格式不支持 | 400 |
| 40005 | 输出格式不支持 | 400 |
| 40006 | 文件大小超限 | 400 |
| 40007 | 并发数超限 | 400 |
| 40008 | 批量任务数量超限 | 400 |
| 40101 | 未授权 | 401 |
| 40301 | 无权限访问模板 | 403 |
| 40401 | 模板不存在 | 404 |
| 40402 | 任务不存在 | 404 |
| 40403 | 文件不存在 | 404 |

### 6.2 服务器错误（5xx）

| 错误码 | 说明 | HTTP状态码 |
|--------|------|-----------|
| 50010 | 渲染失败 | 500 |
| 50020 | 存储失败 | 500 |
| 50030 | 模板加载失败 | 500 |
| 50040 | 校验失败 | 500 |
| 50050 | 加密失败 | 500 |
| 50060 | 图表生成失败 | 500 |
| 50070 | 图片处理失败 | 500 |
| 50080 | 批量任务处理失败 | 500 |
| 50090 | 系统内部错误 | 500 |

---

## 7. 接口调用示例

### 7.1 Python 示例
```python
import requests

# 1. 上传模板
files = {'file': open('template.docx', 'rb')}
data = {
    'name': '报告模板',
    'description': '用于生成分析报告',
    'tags': '报告,分析'
}
response = requests.post('http://localhost:8000/api/v1/templates', files=files, data=data)
template = response.json()['data']
template_id = template['template_id']

# 2. 单文档导出
export_data = {
    'data': {
        'title': '2024年度报告',
        'author': '张三',
        'date': '2024-01-01',
        'table:data': [
            {'name': '产品A', 'sales': 1000},
            {'name': '产品B', 'sales': 2000}
        ]
    },
    'template_ref': template_id,
    'output_format': 'docx',
    'validate': True
}
response = requests.post('http://localhost:8000/api/v1/export', json=export_data)
result = response.json()['data']
print(f"文件路径: {result['file_path']}")
print(f"页数: {result['pages']}")

# 3. 下载文件
file_url = result['file_url']
file_response = requests.get(file_url)
with open('output.docx', 'wb') as f:
    f.write(file_response.content)
```

### 7.2 cURL 示例
```bash
# 上传模板
curl -X POST "http://localhost:8000/api/v1/templates" \
  -F "file=@template.docx" \
  -F "name=报告模板" \
  -F "description=用于生成分析报告"

# 单文档导出
curl -X POST "http://localhost:8000/api/v1/export" \
  -H "Content-Type: application/json" \
  -d '{
    "data": {
      "title": "2024年度报告",
      "author": "张三"
    },
    "template_ref": "tpl_123456",
    "output_format": "docx"
  }'

# 查询任务状态
curl "http://localhost:8000/api/v1/export/tasks/task_789012"
```

---

## 8. 验收标准

### 8.1 功能验收
- ✅ 支持模板上传、版本管理、下载
- ✅ 支持文本、表格、图片、图表占位符填充
- ✅ 支持 Word、PDF、HTML 三种格式导出
- ✅ 支持单文档和批量导出
- ✅ 支持格式校验（数据错位、链接有效性、样式统一性）
- ✅ 提供导出报告和错误日志

### 8.2 性能验收
- ✅ 单文档（100页）生成耗时 ≤ 10 秒
- ✅ 批量导出 100 份报告无内存溢出
- ✅ 模板样式还原度 ≥ 95%
- ✅ 数据填充无错位

### 8.3 质量验收
- ✅ API 接口文档完整
- ✅ 错误处理完善，错误码规范
- ✅ 日志记录完整，支持追踪
- ✅ 代码符合规范，有单元测试

---

## 9. 附录

### 9.1 占位符规范

#### 文本占位符
- 基础：`{{title}}`
- 带过滤器：`{{date | date('%Y-%m-%d')}}`
- 默认值：`{{author | default('未知')}}`

#### 表格占位符
- 基础：`{{table:data}}`
- 带配置：`{{table:data | columns(['name', 'sales']) | merge(['dept'])}}`

#### 图片占位符
- Base64：`{{image:logo}}`（data 中提供 base64 字符串）
- URL：`{{image:logo}}`（data 中提供 URL）
- 本地路径：`{{image:logo}}`（data 中提供路径）

#### 图表占位符
- 折线图：`{{chart:sales_line}}`
- 柱状图：`{{chart:sales_bar}}`
- 饼图：`{{chart:sales_pie}}`

### 9.2 配置示例

详见 `config.example.yaml` 和 `概要与架构设计.md` 中的配置说明。

### 9.3 依赖库版本

详见 `requirements.txt`。

---

**文档版本**：v1.0  
**最后更新**：2024-01-01  
**维护者**：开发团队

